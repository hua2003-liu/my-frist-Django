<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投票详情 - {{ question.question_text }}</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }
        .question-info {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #007bff;
        }
        .question-text {
            font-size: 20px;
            font-weight: 500;
            color: #333;
            margin-bottom: 10px;
        }
        .question-date {
            color: #666;
            font-size: 14px;
        }
        .choices-section {
            margin-bottom: 30px;
        }
        .choices-title {
            font-size: 18px;
            font-weight: 500;
            color: #333;
            margin-bottom: 15px;
        }
        .choice-list {
            list-style: none;
            padding: 0;
        }
        .choice-item {
            background-color: #f8f9fa;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }
        .choice-item:hover {
            background-color: #e9ecef;
            transform: translateX(5px);
        }
        .choice-label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .choice-radio {
            margin-right: 12px;
            transform: scale(1.2);
        }
        .choice-text {
            font-size: 16px;
            color: #333;
        }
        .vote-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        .vote-button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }
        .vote-button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        .back-link {
            color: #007bff;
            text-decoration: none;
            font-size: 14px;
            margin-bottom: 20px;
            display: inline-block;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .no-choices {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="{% url 'polls:index' %}" class="back-link">← 返回投票列表</a>
        
        <h1>🗳️ 投票详情</h1>
        
        <div class="question-info">
            <div class="question-text">{{ question.question_text }}</div>
            <div class="question-date">
                发布时间: {{ question.pub_date|date:"Y年m月d日 H:i" }}
                {% if question.was_published_recently %}
                    <span style="color: #28a745; font-weight: bold;"> (最新)</span>
                {% endif %}
            </div>
        </div>
        
        {% if error_message %}
            <div class="error-message">
                <strong>错误:</strong> {{ error_message }}
            </div>
        {% endif %}
        
        <form action="{% url 'polls:vote' question.id %}" method="post">
            {% csrf_token %}
            
            <div class="choices-section">
                <div class="choices-title">请选择你的答案:</div>
                
                {% if question.choice_set.all %}
                    <ul class="choice-list">
                        {% for choice in question.choice_set.all %}
                        <li class="choice-item">
                            <label class="choice-label">
                                <input type="radio" name="choice" id="choice{{ forloop.counter }}" 
                                       value="{{ choice.id }}" class="choice-radio">
                                <span class="choice-text">{{ choice.choice_text }}</span>
                            </label>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="no-choices">
                        <p>📝 这个问题还没有选项。</p>
                        <p>请联系管理员添加选项。</p>
                    </div>
                {% endif %}
            </div>
            
            {% if question.choice_set.all %}
                <button type="submit" class="vote-button" id="voteBtn" disabled>
                    🗳️ 提交投票
                </button>
            {% endif %}
        </form>
    </div>

    <script>
        // 启用/禁用投票按钮
        const radioButtons = document.querySelectorAll('input[name="choice"]');
        const voteButton = document.getElementById('voteBtn');
        
        radioButtons.forEach(radio => {
            radio.addEventListener('change', function() {
                voteButton.disabled = !this.checked;
            });
        });
        
        // 表单提交确认
        const form = document.querySelector('form');
        form.addEventListener('submit', function(e) {
            const selectedChoice = document.querySelector('input[name="choice"]:checked');
            if (!selectedChoice) {
                e.preventDefault();
                alert('请选择一个选项！');
                return false;
            }
            
            const choiceText = selectedChoice.nextElementSibling.textContent;
            if (!confirm(`确认投票给: ${choiceText}？`)) {
                e.preventDefault();
                return false;
            }
        });
    </script>
</body>
</html>
